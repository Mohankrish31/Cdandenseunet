import torch
from PIL import Image
import numpy as np
# Load full model
model = torch.load("cdandenseunet.pt")
model.eval()
# Load a low-light image
img = Image.open("low_light.png").convert("RGB")
img_tensor = torch.tensor(np.array(img)/255., dtype=torch.float32).permute(2,0,1).unsqueeze(0)
# Run inference
with torch.no_grad():
    enhanced = model(img_tensor)
enhanced_img = (enhanced[0].permute(1,2,0).numpy() * 255).astype(np.uint8)
Image.fromarray(enhanced_img).save("enhanced.png")
